{% extends "base.html" %}
{% load static %}
{% block meta %}
    <title>{{ fran }} - Roboteer's Tavern</title>
    <link rel="stylesheet" href="{% static 'style/franchise_detail.css' %}">
    <link rel="stylesheet" href="{% static 'style/web_links.css' %}">
{% endblock %}
{% block content %}
    {% if fran %}
        <div class="main-content">
        <div class="heading">
            <h1>{{ fran }}</h1>
            <a href="{% url 'main:editFranchise' fran.id %}"><img class="inline-image" src="{% static 'edit.png' %}" alt="Edit Franchise"></a>
        </div>

        {% if fran.logo %}
            <div class="franchise-logo-image">
                <img class="fit-image" src="{{ fran.logo.url }}" alt="logo">
            </div>
        {% endif %}

        <P>{{ fran.description }}</P>

        {% if fran.web_link_set.all|length > 0 %}
        <div class="web-links">
        {% for web in fran.web_link_set.all %}
            <span>
            <a href="{{ web.link }}">
                <img  src="{{ web.get_logo }}" alt="{{ web }}">
                <span class="spacer"></span>
                {{web.get_display}}
            </a>
            </span>
            {%if forloop.counter|divisibleby:5 %}
                </div>
                <div class="web-links">
            {%endif%}
        {% endfor %}
        </div>
        {% endif %}

        {% if fran.members.all|length > 0 %}
            <h2>Members</h2>
            <a class="editor-link" style="display: inline-block" href="{% url 'main:addMember' 'franchise' fran.id %}">Add
                Member</a>
            <p>
                {% for member in fran.members.all %}
                    <span>{{ member }}</span>
                {% endfor %}
            </p>
        {% endif %}


        {%if fran.event_set.all|length > 0%}
        <h2>Events</h2>
        <table>
            <thead>
            <th>Event Name</th>
            <th>Event Date</th>
            </thead>
            <tbody>
            {% for event in fran.event_set.all %}
                <tr>
                    <td><a href="{% url 'main:eventDetail' event.slug %}">{{ event }}</a></td>
                    <td>
                        {% if event.start_date|date:"d M Y" == event.end_date|date:"d M Y" %}
                            {{ event.start_date|date:"d M Y" }}
                        {% elif event.start_date|date:"M" == event.end_date|date:"M" %}
                            {{ event.start_date|date:"d" }} - {{ event.end_date|date:"d M Y" }}
                        {% elif event.start_date|date:"Y" == event.end_date|date:"Y" %}
                            {{ event.start_date|date:"d M" }} - {{ v.event.end_date|date:"d M Y" }}
                        {%else%}
                            {{ event.start_date|date:"d M Y" }} - {{ v.event.end_date|date:"d M Y" }}
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        {%endif%}
    {% else %}
        Something has gone wrong.
    {% endif %}
        </div>
{% endblock %}